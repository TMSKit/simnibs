
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Setting up and Running Simulations &#8212; SimNIBS 4.0b1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Visualizing Results" href="visualization.html" />
    <link rel="prev" title="Tutorial" href="tutorial.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
              <div class="related top">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="tutorial.html" title="Previous document">Tutorial</a>
        </li>
        <li>
          <a href="visualization.html" title="Next document">Visualizing Results</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          

          <div class="body" role="main">
            
  <section id="setting-up-and-running-simulations">
<span id="gui-tutorial"></span><h1>Setting up and Running Simulations<a class="headerlink" href="#setting-up-and-running-simulations" title="Permalink to this heading">¶</a></h1>
<p>This tutorial is based on the <a class="reference internal" href="../dataset.html#dataset"><span class="std std-ref">Example Dataset</span></a>.
Please download it before continuing</p>
<section id="starting-the-gui-and-selecting-a-head-model">
<h2>Starting the GUI and selecting a Head Model<a class="headerlink" href="#starting-the-gui-and-selecting-a-head-model" title="Permalink to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p>Launch the Graphical User Interface (GUI) from the Start Menu or by typing on a terminal window</p></li>
</ol>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>simnibs_gui
</pre></div>
</div>
<p></p>
<p>A window such as the following should appear</p>
</div></blockquote>
<img alt="../_images/tutorial_emptygui.png" class="align-center" src="../_images/tutorial_emptygui.png" />
<ol class="arabic simple" start="2">
<li><p>Click on the <em>Browse</em> button next to the <em>m2m Folder</em> box</p></li>
</ol>
<img alt="../_images/tutorial_bowse.png" class="align-center" src="../_images/tutorial_bowse.png" />
<ol class="arabic simple" start="3">
<li><p>Navigate to the example dataset folder and select the <code class="file docutils literal notranslate"><span class="pre">m2m_ernie</span></code> directory</p></li>
</ol>
<img alt="../_images/tutorial_selectmsh.png" class="align-center" src="../_images/tutorial_selectmsh.png" />
<ol class="arabic simple" start="4">
<li><p>The head mesh will be loaded and the <strong>m2m Folder</strong> and <strong>Output Folder</strong> boxes filled</p></li>
</ol>
<img alt="../_images/tutorial_guihead.png" class="align-center" src="../_images/tutorial_guihead.png" />
<dl class="simple">
<dt></dt><dd><p>You can change the <strong>Output Folder</strong> by clicking on the <em>Browse</em> button close to it, and visualize the gray matter surface by clicking on the <em>Gray Matter</em> button above the head model.</p>
</dd>
</dl>
</section>
<section id="setting-up-a-tdcs-simulation">
<h2>Setting up a tDCS Simulation<a class="headerlink" href="#setting-up-a-tdcs-simulation" title="Permalink to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p>Click on <em>Add tDCS Poslist</em> at the bottom left of the window</p></li>
</ol>
<img alt="../_images/tutorial_addtdcs.png" class="align-center" src="../_images/tutorial_addtdcs.png" />
<dl class="simple">
<dt></dt><dd><p>A new tab will show up.</p>
</dd>
</dl>
<ol class="arabic simple" start="2">
<li><p>Click on <em>Add Electrode</em></p></li>
</ol>
<img alt="../_images/tutorial_addelectrode.png" class="align-center" src="../_images/tutorial_addelectrode.png" />
<dl class="simple">
<dt></dt><dd><p>A new row will be shown in the table</p>
</dd>
</dl>
<ol class="arabic simple" start="3">
<li><p>Click twice in the <em>Shape</em> cell</p></li>
</ol>
<img alt="../_images/tutorial_shapecell.png" class="align-center" src="../_images/tutorial_shapecell.png" />
<dl class="simple">
<dt></dt><dd><p>A new window will open where you can configure the electrode size and shape.</p>
</dd>
</dl>
<ol class="arabic simple" start="4">
<li><p>Let’s suppose we have a <span class="math notranslate nohighlight">\(7.0 \times 5.5 \text{cm}^2\)</span> electrode, composed of a single gel layer of 5 mm thickness</p></li>
</ol>
<img alt="../_images/tutorial_electrodegui.png" class="align-center" src="../_images/tutorial_electrodegui.png" />
<dl class="simple">
<dt></dt><dd><p>Please refer to the <a class="reference internal" href="../documentation/gui.html#gui-docs"><span class="std std-ref">GUI documentation</span></a> for a more detailed explanation of this window. You can also copy/paste electrode definitions by right clicking in the shape cell</p>
</dd>
</dl>
<ol class="arabic simple" start="5">
<li><p>Now double click in the <em>Position</em> cell. A new window will appear. You can either select an EEG position from the drop-down menu in the left or click twice in the model to get a position.</p></li>
</ol>
<img alt="../_images/tutorial_position1.png" class="align-center" src="../_images/tutorial_position1.png" />
<p></p>
<ol class="arabic simple" start="6">
<li><p>Choose the C3 electrode from the drop-down menu. A black sphere appears in the electrode position, with a green axis indicating the electrode’s “y” axis</p></li>
</ol>
<img alt="../_images/tutorial_position2.png" class="align-center" src="../_images/tutorial_position2.png" />
<p></p>
<ol class="arabic simple" start="7">
<li><p>Select the electrode <em>current</em> in the first column of the electrode tables. <strong>Positive</strong> values designate <strong>anodes</strong>, and <strong>negative</strong> values <strong>cathodes</strong>. The sum of all current values has to be zero.</p></li>
</ol>
<img alt="../_images/tutorial_elcurrent.png" class="align-center" src="../_images/tutorial_elcurrent.png" />
<p></p>
<ol class="arabic simple" start="8">
<li><p>Now add a second electrode, place it at AF4 and double click on a nearby position to rotate it, aligning the green axis with the top/down direction.</p></li>
</ol>
<img alt="../_images/tutorial_position3.png" class="align-center" src="../_images/tutorial_position3.png" />
<dl class="simple">
<dt></dt><dd><p>Select a shape and a current of <span class="math notranslate nohighlight">\(-1.000 \text{mA}\)</span> for this second electrode.
You can see a simple preview of the electrode shapes by clicking on <em>Preview Shapes</em> at the bottom of the screen</p>
</dd>
</dl>
</section>
<section id="setting-up-a-tms-simulation">
<h2>Setting up a TMS Simulation<a class="headerlink" href="#setting-up-a-tms-simulation" title="Permalink to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p>Click on <em>Add TMS Poslist</em> in the bottom of the window. A new TMS tab will be created</p></li>
</ol>
<img alt="../_images/tutorial_addtms.png" class="align-center" src="../_images/tutorial_addtms.png" />
<p>2. Click on <em>Browse</em> and select the <em>Magstim_70mm_Fig8.nii.gz</em> coil file in the <em>legacy</em> subfolder</p>
<img alt="../_images/tutorial_addcoil.png" class="align-center" src="../_images/tutorial_addcoil.png" />
<p>3. Click on <em>Add Position</em></p>
<img alt="../_images/tutorial_addposition.png" class="align-center" src="../_images/tutorial_addposition.png" />
<p>4. Double click in the <em>Position</em> cell</p>
<img alt="../_images/tutorial_positioncell.png" class="align-center" src="../_images/tutorial_positioncell.png" />
<p>5. You can select the coil position the same way as an electrode position, or alternatively by double clicking in the head model. In the TMS case, the Y axis where the coil is pointing. Here, we will click on the <em>Gray Matter</em> button above the model window and place the coil above the motor cortex, with the green axis pointing anteriorly. This means that the coil handle points posteriorly. <a class="reference download internal" download="" href="../_downloads/46a4ff127db96296fb4238660aec96f0/coil_axesorientation.pdf"><code class="xref download docutils literal notranslate"><span class="pre">See</span> <span class="pre">here</span> <span class="pre">for</span> <span class="pre">more</span> <span class="pre">information</span> <span class="pre">on</span> <span class="pre">coil</span> <span class="pre">coordinates</span></code></a></p>
<img alt="../_images/tutorial_coilpos.png" class="align-center" src="../_images/tutorial_coilpos.png" />
<p></p>
<ol class="arabic simple" start="6">
<li><p>Additionally, you can also set the dI/dt (the current change ratio) and the coil-skin distance.</p></li>
<li><p>When using a <em>.nii.gz</em> coil file, click on <em>Show dA/dt field</em> to see the magnitude of the primary electric field.</p></li>
</ol>
<img alt="../_images/tutorial_dadt.png" class="align-center" src="../_images/tutorial_dadt.png" />
<p></p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>This is <strong>NOT the electric field</strong>, but it can be interpreted as a very smooth approximation of it.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Most coil files are supplied in <em>.ccd</em>-format, which need less disk space compared to <em>.nii.gz</em>. However, the preview option <em>Show dA/dt field</em> in the GUI currently works only for <em>.nii.gz</em> coil file. If needed, you can use the command line tool <a class="reference internal" href="../documentation/command_line/ccd2nifti.html#ccd2nifti-doc"><span class="std std-ref">ccd2nifti</span></a> to convert coil files from <em>.ccd</em> to <em>.nii.gz</em>.</p>
</div>
</section>
<section id="setting-simulation-options">
<h2>Setting Simulation Options<a class="headerlink" href="#setting-simulation-options" title="Permalink to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p>Go to <em>Edit</em> → <em>Simulation Options</em></p></li>
</ol>
<img alt="../_images/tutorial_simoptions.png" class="align-center" src="../_images/tutorial_simoptions.png" />
<dl class="simple">
<dt></dt><dd><p>The following window will appear</p>
</dd>
</dl>
<img alt="../_images/tutorial_simoptions2.png" class="align-center" src="../_images/tutorial_simoptions2.png" />
<p></p>
<ol class="arabic simple" start="2">
<li><p>We can select the <em>fields</em> to be output from the simulation</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><dl class="simple">
<dt><strong>v</strong>:</dt><dd><p>Electrical Potential (Voltage). Units: Volts</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>vector E</strong>:</dt><dd><p>Electric field vector. Units: V/m</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>magn E</strong>:</dt><dd><p>Magnitude (or strength) of the electric field. Units: V/m</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>vector J</strong>:</dt><dd><p>Current density vector. Units: A/m²</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>magn J</strong>:</dt><dd><p>Magnitude of the current density. Units: A/m²</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>Conductivities</strong>:</dt><dd><p>Conductivity field. For isotropic conductivities, this is a scalar.
For anisotropic conductivities, this is the largest eigenvector of the conductivity tensor.
Units: S/m</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>dA/dt</strong>:</dt><dd><p>Primary field caused by the coil. TMS only. This is a vector field. Units: V/m</p>
</dd>
</dl>
</li>
</ul>
<blockquote>
<div><p>Select <strong>vector E</strong> and <strong>magn E</strong>.</p>
</div></blockquote>
</div></blockquote>
<ol class="arabic simple" id="tutorial-aditional-options" start="3">
<li><p>And the  <em>Additional Options</em></p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><dl class="simple">
<dt><strong>Open in Gmsh</strong>:</dt><dd><p>Opens the simulation results in <em>Gmsh</em></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>Interpolate to cortical surface</strong>:</dt><dd><p>Interpolates the fields along a surface at the center of the gray matter sheet. Not available for <a class="reference internal" href="../documentation/command_line/headreco.html#headreco-docs"><span class="std std-ref">headreco</span></a> models ran with <code class="code docutils literal notranslate"><span class="pre">--no-cat</span></code>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>Transform to fsaverage space</strong>:</dt><dd><p>Interpolates to the middle of gray matter and transforms it to FsAverage space. Not available for <a class="reference internal" href="../documentation/command_line/headreco.html#headreco-docs"><span class="std std-ref">headreco</span></a> models ran with <code class="code docutils literal notranslate"><span class="pre">--no-cat</span></code>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>Interpolate to a nifiti volume</strong>:</dt><dd><p>Interpolates the fields to a nifti volume.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>Transform to MNI space</strong>:</dt><dd><p>Interpolates the fields to a nifti volume and applies a transformation to MNI space.</p>
</dd>
</dl>
</li>
</ul>
<p>For the example run, we will select all of the above.</p>
</div></blockquote>
</section>
<section id="running-a-simulation">
<h2>Running a Simulation<a class="headerlink" href="#running-a-simulation" title="Permalink to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p>Click on Run at the bottom of the screen</p></li>
</ol>
<img alt="../_images/tutorial_runsim.png" class="align-center" src="../_images/tutorial_runsim.png" />
<p>2. If there are no errors in the problem set-up, a new window will appear and show the simulation progress. The simulation takes a few minutes, and when finished a Gmsh window opens with the simulation results.</p>
<p>Now, please go on to our tutorial on <a class="reference internal" href="visualization.html#visualization-tutorial"><span class="std std-ref">Visualizing Results</span></a>.</p>
</section>
<section id="output-files">
<h2>Output Files<a class="headerlink" href="#output-files" title="Permalink to this heading">¶</a></h2>
<p>After the simulation is finished, the <code class="file docutils literal notranslate"><span class="pre">simnibs_simulation</span></code> directory will look like the following</p>
<img alt="../_images/tutorial_output_files.png" class="align-center" src="../_images/tutorial_output_files.png" />
<p></p>
<p>The main files here are the <code class="file docutils literal notranslate"><span class="pre">.msh</span></code> files</p>
<blockquote>
<div><ul class="simple">
<li><dl class="simple">
<dt><code class="file docutils literal notranslate"><span class="pre">ernie_TDCS_1_scalar.msh</span></code></dt><dd><p>With results of the tDCS simulation</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="file docutils literal notranslate"><span class="pre">ernie_TMS_2-0001_Magstim_70mm_Fig8_nii_scalar.msh</span></code></dt><dd><p>With results of the TMS simulation</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<dl class="simple">
<dt>The folders</dt><dd><ul class="simple">
<li><p><code class="file docutils literal notranslate"><span class="pre">fsavg_overlays</span></code></p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">mni_volumes</span></code></p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">subject_overlays</span></code></p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">subject_volumes</span></code></p></li>
</ul>
</dd>
</dl>
<p>Are only present if the corresponding <a class="reference internal" href="#tutorial-aditional-options"><span class="std std-ref">options</span></a> are
selected.</p>
<p>For a complete explanation of the output, please see <a class="reference internal" href="../documentation/output_files.html#output-files"><span class="std std-ref">Output Files</span></a></p>
</section>
<section id="further-reading">
<h2>Further Reading<a class="headerlink" href="#further-reading" title="Permalink to this heading">¶</a></h2>
<p>For more information on the GUI, please see the <a class="reference external" href="https://doi.org/10.1101/500314">SimNIBS 2.1 tutorial paper</a>.</p>
</section>
</section>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="tutorial.html" title="Previous document">Tutorial</a>
        </li>
        <li>
          <a href="visualization.html" title="Next document">Visualizing Results</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo.png" alt="Logo"/>
    
  </a>
</p>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dataset.html">Example Dataset</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="tutorial.html">Tutorial</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Setting up and Running Simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="visualization.html">Visualizing Results</a></li>
<li class="toctree-l2"><a class="reference internal" href="head_meshing.html">Creating Head Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="scripting.html">Scripting Simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="analysis.html">Analyzing Simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="optimization.html">TDCS Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="tms_optimization.html">TMS Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced/advanced.html">Advanced Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="win_prompt.html">Accessing the Command Prompt on Windows</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../documentation/documentation.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gallery.html">Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributors.html">Contributors and Funding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../publications.html">Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contact.html">Contact</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="tutorial.html">Tutorial</a><ul>
      <li>Previous: <a href="tutorial.html" title="previous chapter">Tutorial</a></li>
      <li>Next: <a href="visualization.html" title="next chapter">Visualizing Results</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, SimNIBS Developers.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.0.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/tutorial/gui.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>